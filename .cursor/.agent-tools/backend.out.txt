
> marketing-co-pilot-backend@1.0.0 start
> node dist/index.js

ğŸ›’ CommerceAudienceService: CSV mode (fallback)
ğŸ“Š CensusDataService: CSV mode (fallback)
ğŸ“Š CensusDataService: CSV mode (fallback)
âœ… Loaded commerce baseline from cache (calculated 10/9/2025, 8:00:53 PM)
ğŸ“Š Loading user-level overlap data from CSV: /Users/cgeorge/Deal-Library/deal-library-backend/data/199_Audience_Overlap_Data.csv
âœ… Loaded user-level overlap data from CSV
   ğŸ“Š 199 segments with overlap data
   ğŸ”— 970 total overlap relationships
   â˜• Coffee overlaps: Household Supplies (52%), Exercise & Fitness (50%), Alcoholic Beverages (46%)
âš ï¸  Missing environment variables (development): GOOGLE_APPS_SCRIPT_URL
Some features may be limited without these variables.
ğŸ“ Loaded persisted state from previous session
ğŸ”„ PersistenceService initialized - context will be preserved across restarts
âš ï¸  GOOGLE_APPS_SCRIPT_URL not configured - Apps Script integration will be unavailable
ğŸ“Š CensusDataService: Supabase mode enabled
âœ… Gemini AI service initialized
ğŸ”„ Initializing embedding service...
âœ… Vector embeddings service initialized
ğŸš€ Sovrn Marketing Co-Pilot Backend running on port 3002
ğŸ“Š Environment: development
ğŸ”— Health check: http://localhost:3002/health
ğŸ“‹ API endpoints:
   GET    /api/deals
   GET    /api/deals/:id
   POST   /api/deals
   PUT    /api/deals/:id
   POST   /api/custom-deal-request
   POST   /api/deals/search
   POST   /api/audience-insights
   POST   /api/market-sizing
   POST   /api/geographic-insights
   POST   /api/unified-search
   POST   /api/census/load
   POST   /api/census/query
   POST   /api/census/zip-codes
   POST   /api/census/search-location
   GET    /api/census/status
   POST   /api/commerce-audiences/load
   GET    /api/commerce-audiences/segments
   POST   /api/commerce-audiences/search-zip-codes
   POST   /api/commerce-audiences/zip-codes-data
   GET    /api/commerce-audiences/status
   POST   /api/audience-geo-analysis/generate
   GET    /api/audience-geo-analysis/segments
   GET    /api/audience-geo-analysis/status
   POST   /api/audience-geo-analysis/export-pdf
âœ… Embedding service initialized
ğŸ¯ Generating Audience Insights Report for: Audio
   Include Commercial ZIPs: NO (default: residential only)

================================================================================
ğŸ¯ Generating Audience Insights Report for: "Audio"
   Include Commercial ZIPs: NO (residential only)
================================================================================

ğŸ“Š Calculating commerce audience baseline (SEGMENT MEDIAN approach)...
   This represents the median "online shopper" across all 196 segments
   Analyzing 0 commerce segments individually...
   âœ… Calculated medians for 0 segments
ğŸ’¾ Saved commerce baseline to cache
âœ… Commerce baseline calculated successfully (SEGMENT MEDIAN approach)
   Method: Median of 0 segment medians
   
   ğŸ“Š BASELINE VALUES (Median "Online Shopper"):
      Income: $0
         Range: $0 - $0
      Education: 0%
         Range: 0.0% - 0.0%
      Age: 0 years
      Home Ownership: 0%
      Household Size: 0 people
      Home Value: $0
   
   ğŸ†• LIFESTYLE BASELINE:
      Self-Employed: 0%
      Married: 0%
      Dual Income: 0%
      Avg Commute: 0 min
      Charitable: 0%
      STEM: 0%
   
   â±ï¸  Calculation time: 0.0s
ğŸ“Š Commerce baseline: $0, 0% edu (4ms)
ğŸ” Getting top geo concentration for: "Audio"
âš ï¸ Commerce audience data not loaded
âš ï¸  No audience data found for segment: "Audio"
ğŸ“ Found 0 high-concentration ZIP codes (0ms)
ğŸ“Š Aggregating demographics for 0 ZIP codes
ğŸ“Š Loading US Census data from CSV...
ğŸ“ˆ Processing 41552 census records...
âœ… Census data loaded successfully:
   ğŸ“ 33782 zip codes
   ğŸ›ï¸ 56 states
   ğŸ‘¥ Average population: 9,933
   ğŸ’° Average income: $69,157
   Median HHI: 70420 (+0.0% vs national) - Middle
   Top age bracket: 25-44, Median: 38.5
   Education (Bachelor's+): 35.0% (+0.0% vs national) - College-Educated
   Family: Couples & Small Families (avg 2.5 people, +0.0% vs national)
   Location: Suburban Homeowners (65% homeowners, median home value $300000)
   Six-figure households: 0%
   ğŸ†• LIFESTYLE: SelfEmp 0.0%, Married 0.0%, DualInc 0.0%, Commute 0min, Charity 0.0%, STEM 0.0%
ğŸ“Š Aggregated demographics for 0 ZIPs (501ms)
ğŸ—ºï¸  Identified top markets:  (0ms)
ğŸ”— Calculating behavioral overlaps for: "Audio"
   âš¡ Using pre-calculated overlaps (instant lookup!)
   âœ… Found top 5 overlapping segments
      1. Tablet Computers: 27.0% overlap
      2. Magazines & Newspapers: 23.0% overlap
      3. Cameras & Optics: 21.0% overlap
      4. Baby & Toddler: 18.0% overlap
      5. Pasta & Noodles: 17.0% overlap
ğŸ”— Identified 5 overlapping segments (1ms)
ğŸ“Š vs Commerce: Income +Infinity%, Education +Infinity%
âœ¨ Generating strategic insights with Gemini for: "Audio"
âœ… Gemini service initialized for Audience Insights
ğŸ“„ Raw Gemini response length: 3525 chars
âœ… Parsed JSON from code block
âœ¨ Generated strategic insights with Gemini (35864ms)
ğŸ“ Generating executive summary with Gemini
ğŸ“ Generated executive summary (7996ms)

ğŸ‘¤ Generating AI persona for: "Audio"
âœ… AI Persona: "The Connected Sound Seeker" ğŸ§
ğŸ‘¤ Generated AI persona: "The Connected Sound Seeker" ğŸ§ (10540ms)
ğŸ’¾ Report cached for "Audio"
â±ï¸  TOTAL REPORT GENERATION TIME: 54.91s

ğŸ” AppsScriptService.getAllDeals called, baseUrl: null
âš ï¸  Apps Script URL not configured - returning empty deals array
âš ï¸  No deals available for matching
[0mPOST /api/audience-insights/generate [32m200[0m 54919.327 ms - 6866[0m
[0mGET /health [32m200[0m 0.653 ms - 193[0m
[0mGET /api/census/status [32m200[0m 0.580 ms - 58[0m
[0mGET /api/commerce-audiences/segments [32m200[0m 2.488 ms - 40[0m
ğŸ“Š Loading census data...
ğŸ“Š Loading US Census data from Supabase...
ğŸ”Œ Initializing Supabase client...
âœ… Supabase client initialized
ğŸ“ˆ Processing 41351 census records from Supabase...
âœ… Loaded 41351 ZIP codes from Supabase
   States: 62
   Avg Population: 8,087
   Avg Income: $56,218
[0mPOST /api/census/load [32m200[0m 6494.074 ms - 523[0m
ğŸ“Š Loading commerce audience data...
ğŸ“Š Loading Commerce Audience segments data from CSV...
âœ… Commerce audience data loaded successfully:
   ğŸ“ 2071130 ZIP codes
   ğŸ¯ 196 audience segments
   ğŸ“Š Average weight: 1803
[0mPOST /api/commerce-audiences/load [32m200[0m 2486.576 ms - 21250[0m
[0mGET /api/census/status [32m200[0m 0.539 ms - 61[0m
[0mGET /api/commerce-audiences/segments [32m200[0m 866.937 ms - 20607[0m
ğŸ“Š Loading commerce audience data...
ğŸ“Š Loading Commerce Audience segments data from CSV...
âœ… Commerce audience data loaded successfully:
   ğŸ“ 2071130 ZIP codes
   ğŸ¯ 196 audience segments
   ğŸ“Š Average weight: 1803
[0mPOST /api/commerce-audiences/load [32m200[0m 2589.851 ms - 21250[0m
ğŸ“Š Loading commerce audience data...
ğŸ“Š Loading Commerce Audience segments data from CSV...
âœ… Commerce audience data loaded successfully:
   ğŸ“ 2071130 ZIP codes
   ğŸ¯ 196 audience segments
   ğŸ“Š Average weight: 1803
[0mPOST /api/commerce-audiences/load [32m200[0m 2352.591 ms - 21250[0m
